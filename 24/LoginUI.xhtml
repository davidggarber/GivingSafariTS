<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="UTF-8"></meta>
    <script> var exports = {}; </script>
    <script src="../js/kit24.js"></script>
    <script>
      const boiler = {
        safari: 'gs24',
        reloadOnRefresh: false,
        reactiveBuilder: 'pageBody',
        paperSize: 'postcard',
        preSetup: toggleLogout,
        postSetup: postSetup,
        lookup: {
          isModal: window.location.search.indexOf('modal') >= 0
        }
      };

      function postSetup() {
        var body = document.getElementById('login');
        toggleClass(body, 'logout', !!_playerName);
        initFields(false);
      }

      function toggleLogout(toggle) {
        var body = document.getElementById('login');
        if (toggle) {
          toggleClass(body, 'logout');
        }
        initFields(toggle);
      }

      function initFields(toggle) {
        var body = document.getElementById('login');
        if (hasClass(body, 'logout')) {
          document.getElementById('logout-player').innerText = _playerName;
          document.getElementById('as-avatar').innerText = _emojiAvatar;
          if (_teamName) {
            document.getElementById('on-team-name').innerText = `On team ${_teamName}.`;
          }
          else {
            document.getElementById('on-team-name').innerText = 'Playing solo.';
          }
        }
        else if (!toggle) {
          randomEmoji();        
        }
      }

      function max1emoji() {
        var avatar = document.getElementById('avatar');
        var chars = splitEmoji(avatar.value);
        if (chars.length > 1) {
          avatar.value = chars[chars.length - 1];
          avatar.select();
        }
      }

      function selectAll(input) {
        input.select();
      }

      var emojiAnimals = "ü¶Äü¶ûü¶êü¶ëüêµüêíü¶çü¶ßüê∂üêïü¶Æüêï‚Äçü¶∫üê©üê∫ü¶äü¶ùüê±üêàüêà‚Äç‚¨õü¶ÅüêØüêÖüêÜüê¥ü´éü´èüêéü¶Ñü¶ìü¶åü¶¨üêÆüêÇüêÉüêÑüê∑üêñüêóüêΩüêèüêëüêêüê™üê´ü¶ôü¶íüêòü¶£ü¶èü¶õüê≠üêÅüêÄüêπüê∞üêáüêøÔ∏èü¶´ü¶îü¶áüêªüêª‚Äç‚ùÑÔ∏èüê®üêºü¶•ü¶¶ü¶®ü¶òü¶°üêæü¶Éüêîüêìüê£üê§üê•üê¶üêßüïäÔ∏èü¶Öü¶Üü¶¢ü¶âü¶§ü™∂ü¶©ü¶öü¶úü™Ωüê¶‚Äç‚¨õü™øüê∏üêäüê¢ü¶éüêçüê≤üêâü¶ïü¶ñüê≥üêãüê¨ü¶≠üêüüê†üê°ü¶àüêôüêöü™∏ü™ºüêåü¶ãüêõüêúüêùü™≤üêûü¶óü™≥üï∑Ô∏èüï∏Ô∏èü¶Çü¶üü™∞ü™±ü¶†";
      var emojiMore = "üíêüå∏üíÆü™∑üèµÔ∏èüåπü•Äüå∫üåªüåºüå∑ü™ªüå±ü™¥üå≤üå≥üå¥üåµüåæüåø‚òòÔ∏èüçÄüçÅüçÇüçÉü™πü™∫üçÑüçáüçàüçâüçäüçãüçåüççü•≠üçéüçèüçêüçëüçíüçìü´êü•ùüçÖü´íü••ü•ëüçÜü•îü•ïüåΩüå∂Ô∏èü´ëü•íü•¨ü•¶üßÑüßÖü•úü´òüå∞ü´öü´õüçûü•êü•ñü´ìü•®ü•Øü•ûüßáüßÄüçñüçóü•©ü•ìüçîüçüüçïüå≠ü•™üåÆüåØü´îü•ôüßÜü•öüç≥ü•òüç≤ü´ïü•£ü•óüçøüßàüßÇü•´üç±üçòüçôüçöüçõüçúüçùüç†üç¢üç£üç§üç•ü•Æüç°ü•üü•†ü•°ü¶™üç¶üçßüç®üç©üç™üéÇüç∞üßÅü•ßüç´üç¨üç≠üçÆüçØüçºü•õ‚òïü´ñüçµüç∂üçæüç∑üç∏üçπüç∫üçªü•Çü•Éü´óü•§üßãüßÉüßâüßäü´ô"
        + "üéÉüéÑüéÜüéáüß®‚ú®üéàüéâüéäüéãüéçüééüéèüéêüéëüßßüéÄüéÅüéóÔ∏èüéüÔ∏èüé´üéñÔ∏èüèÜüèÖ‚öΩ‚öæü•éüèÄüèêüèàüèâüéæü•èüé≥üèèüèëüèíü•çüèìüè∏ü•äü•ãü•Ö‚õ≥‚õ∏Ô∏èüé£ü§øüéΩüéøüõ∑ü•åüéØü™Äü™Åüî´üé±üîÆü™ÑüéÆüïπÔ∏èüé∞üé≤üß©üß∏ü™Öü™©ü™Ü‚ôüÔ∏èüÉèüÄÑüé¥üé≠üñºÔ∏èüé®üßµü™°üß∂ü™¢"
        + emojiAnimals;
      function randomEmoji(wider) {
        var chars = splitEmoji(wider ? emojiMore : emojiAnimals);
        var rand = parseInt(Math.random() * chars.length);
        document.getElementById('avatar').value = chars[rand];
      }

      function validateName() {
        var pName = document.getElementById('playerName')?.value || '';
        if (pName.trim().length > 0) {
          document.getElementById('login-button').removeAttribute('disabled');
        }
        else {
          document.getElementById('login-button').setAttribute('disabled', true);
        }
      }

      function login() {
        var pName = document.getElementById('playerName').value;
        var tName = document.getElementById('teamName').value;
        var emoji = document.getElementById('avatar').value;
        doLogin(pName, tName, emoji);
        if (urlArgExists('modal')) {
          dismissModal();
        }
        else {
          // Pivot UI to LogOut
          toggleLogout(true);
        }
      }

      function logout() {
        const isModal = urlArgExists('modal');
        doLogout(isModal, document.getElementById('delete').checked);
        if (isModal) {
          dismissModal();
        }
        else {
          // Pivot UI to LogIn
          toggleLogout(true);
        }
      }

      function dismissModal() {
        try {
          parent.dismissLogin();
        }
        catch {
          // Will fail when running on local file: protocol
        }        
      }

      function cancel() {
        dismissModal();
      }

    </script>
    <style>
      body {
        background-color: white;
        overflow: hidden;
      }
      #login #Login-bar {
        display: none;
      }
      #logo {
        height: 1.1in;
      }
      #login-table {
        margin: 0.5in 0.25in 0px 0.25in;
      }
      #logout-table {
        display: none;
        margin: 0.5in 0.25in 0px 0.25in;
      }
      .logout #login-table {
        display: none;
      }
      .logout #logout-table {
        display: block;
      }

      input.text {
        font-size: 16pt;
        width: 95%;
      }
      #avatar {
        width: 0.75in;
        font-size: 24pt;
        text-align: center;
      }
      #as-avatar {
        font-size: 16pt;
      }
      .avatar-top {
        position: relative;
        top: -16px;
        cursor: help;
      }
      .avatar-middle {
        position: relative;
        top: -8px;
      }
      #login #page {
        height: 2in;
      }
      button {
        font-size: 16pt;
      }

      .titlebar {
        position: absolute;
        top: 0px;
        left: 0px;
        width: 5in;
        height: 28px;
        font-size: 14pt;
        background-color: rgb(45, 85, 164);
        color: white;
        padding: 4px;
        text-align: center;
      }
      .logout #login-titlebar {
        display:none;
      }
      #logout-titlebar {
        display:none;
        background-color: rgb(164, 45, 45);
      }
      .logout #logout-titlebar {
        display:block;
      }

    </style>
  </head>
  <body id="login" class="">
    <div id='pageBody'>
      <div id="login-titlebar" class="titlebar">
        Log in to Giving Safari 24
      </div>
      <table id="login-table">
        <tr>
          <th style="width:1in;">Your name</th>
          <td><input id="playerName" type="text" class="text" oninput="validateName()" /></td>
          <td rowspan="3" style="vertical-align: top;">
            <img id="logo" src="Images/GS24_logo.png" />            
          </td>
        </tr>
        <tr>
          <th>Emoji avatar</th>
          <td><input id="avatar" type="text" class="text" oninput="max1emoji()" onfocus="selectAll(this)" />
              <sup class="avatar-top" title="Will be used in some group UI">‚≠ê</sup>
              <a class="avatar-middle" href="javascript:randomEmoji(true)">randomize!</a>
          </td>
        </tr>
        <tr>
          <th>Team name</th>
          <td><input id="teamName" type="text" class="text" /></td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td colspan="2">
            <i>Leave the team blank if you are playing solo.</i>
          </td>
        </tr>
        <tr>
          <td></td>
          <td style="text-align: center;">
            <button id="login-button" onclick="login()" disabled="true">Login</button>
            <if test="{isModal}">
              <button onclick="cancel()">Cancel</button>
            </if>
          </td>
        </tr>
      </table>

      <div id="logout-titlebar" class="titlebar">
        Log out of Giving Safari 24 ?
      </div>
      <table id="logout-table">
        <tr>
          <th style="width:3.25in;">You are logged in as <u id="logout-player"></u></th>
          <td rowspan="3" style="vertical-align: top;">
            <img id="logo" src="Images/GS24_logo.png" />            
          </td>
        </tr>
        <tr>
          <th>With emoji avatar <span id="as-avatar"></span></th>
        </tr>
        <tr>
          <th id="on-team-name">On team</th>
        </tr>
        <tr>
          <td colspan="2" style="text-align: center;">
            <if test="{isModal}">
              <button onclick="logout()">Confirm Logout</button>
              <button onclick="cancel()">Cancel</button>
            </if>
            <else>
              <button onclick="logout()">Logout</button>
            </else>
            <br />
            <span style="white-space: nowrap" trim="all">
              <input type="checkbox" id="delete" /> 
              <label for="delete">Delete data</label>
            </span>
          </td>
        </tr>
      </table>

    </div>
  </body>
</html>
<html>
  <head>
    <meta charset="UTF-8"></meta>
    <title>Seven Wonders</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Overpass&display=swap" rel="stylesheet">
    <link href="Kit/PageSizes.css" rel="Stylesheet" type="text/css"></link>
    <link href="Kit/PuzzleParts.css" rel="Stylesheet" type="text/css"></link>
    <link href="Kit/TextInput.css" rel="Stylesheet" type="text/css"></link>
    <link href="Kit/DragDrop.css" rel="Stylesheet" type="text/css"></link>

    <script src="Kit/ClassUtils.js"></script>
    <script src="Kit/DragDrop.js"></script>
    <script src="Kit/Storage.js"></script>
    <script src="Kit/Notes.js"></script>
    <script src="Kit/TextSetup.js"></script>
    <script src="Kit/TextInput.js"></script>
  </head>
  <style>
    #prereqs {
      margin-top: 0.5in;
    }
    #prereqs img {
      height: 0.25in;
    }
    sub {
      position: relative;
      left: -.5em;
      cursor: pointer;
      color: darkcyan;
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      left: -5px;
    }

    #instructions {
      margin-top: 0.25in;
    }
    #table {
      border-collapse: collapse;
      margin-left: 1in;
    }
    #table td {
      width: 1.35in;
      height: 1.35in;
      border: solid 1px black;
      padding: 0px;
    }

    #bottom {
      margin-top: 0.5in;
      text-align: center;
    }
    .letter-cell {
      font-family: 'Kalam', cursive;
      font-size: 28pt;
      width: 2.5ex;
      height: 2.5ex;
    }
    #meta-materials {
      position: absolute;
      left: 8.75in;
      top: 0px;
      width: 6in;
    }
    #meta-materials img {
      height: 0.25in;
    }
    .meta-found {
      display: none;
    }

    .drag-source {
      display: inline-block;
      width: 1.75in;
      height: 1.75in;
      vertical-align: top;
    }

    .square {
      display: inline-block;
      width: 2.5in;
      height: 2.5in;
      padding: 0.2in;
      border: solid 5px black;
      background-color: #F9E1BD;

      -moz-user-select: -moz-none;
      -khtml-user-select: none;
      -webkit-user-select: none;
      -o-user-select: none;
      user-select: none;
    }

    .square .title {
      font-family: 'Courier New', Courier, monospace;
      font-size: 12pt;
      font-weight: bold;
    }

    .square .exit {
      background-color: #BF9000;
      border: solid 1px black;
      position: absolute;
    }
    .square .exit.east {
      width: 3%;
      right: -5px;
      height: 56%;
      top: 22%;
    }
    .square .exit.west {
      width: 3%;
      left: -5px;
      height: 56%;
      top: 22%;
    }
    .square .exit.north {
      height: 3%;
      top: -5px;
      width: 56%;
      left: 22%;
    }
    .square .exit.south {
      height: 3%;
      bottom: -5px;
      width: 56%;
      left: 22%;
    }

    .small.square {
      width: 128px;
      height: 128px;
      margin: 0px;
      border: solid 1px black;
      padding: 0px;
      text-align: center;
      position: relative;
    }
    .small.square .title {
      text-align: center;
      margin-top: 0.25in;
    }
    .small.square .exit.east {
      right: -1px;
    }
    .small.square .exit.west {
      left: -1px;
    }
    .small.square .exit.north {
      top: -1px;
    }
    .small.square .exit.south {
      bottom: -1px;
    }
    .small.square .tip-emoji {
      display: inline-block;
      text-align: center;
      font-size: 14pt;
      position: relative;
    }

    .big.square {
      display: none;
      text-align: left;
    }
    .big.square .title {
      text-align: left;
      margin: 0px;
    }
    .big.square p {
      font-family: 'Courier New', Courier, monospace;
      font-size: 9.5pt;
    }
    .big.square p.exits {
      font-size: 8pt;
    }
    .tip-emoji:hover .big.square {
      display: block;
      position: absolute;
      left: -1in;
      top: -0.3in;
      width: 2.5in;
      height: 2.5in;
      text-align: left;
      background-color: #f2c177;
      z-index: 1000;
      animation-name: opacity-fadein;
      animation-duration: 0.7s;
      opacity: 0.9;
    }
    @keyframes opacity-fadein {
      from {
        opacity: 0;
      }
      to {
        opacity: 0.9;
      }
    }

    @media print {
      #meta-materials {
        display: none;
      }
    }
  </style>
  <body class="letter portrait" onload="onLoad()">
    <div id="page" class="printedPage">  <!--Printable paper-->
      <div class="pageWithinMargins">
        <div id="title">
          Seven Wonders
        </div>
        <div id="icons">
          <img src="Icons/Meta.png">
        </div>
        <div id="copyright">
            &copy;2019 Jesse McGatha
        </div>
        <a id="backlink" target="_blank" href="safari.html">Puzzle list</a>
        <img id="qr" src="QR/SevenWonders.png">

        <div id="pageBody">
          <p id="prereqs" class="flavor">
            This is a metapuzzle. 
            It requires 7 pieces you receive from the answer system when solving feeder puzzles with the <img src="Icons/Seven.png"> seven icon.
            Specifically, you need <img src="Icons/Seven.png"><sub>A</sub> through <img src="Icons/Seven.png"><sub>G</sub>. Each has two puzzles that will earn it.
          </p>
          <p id="instructions" class="flavor">
            Solving all puzzles is likely not required. As you discover meta materials, they will also show up here.
            Alternatively, you may want to print and cut out the pieces as you get them.
            <br>You may not know what you need initially but put it together and you might put it together.
          </p>
          <table id="table">
            <tr>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
            </tr>
            <tr>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
            </tr>
            <tr>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
            </tr>
            <tr>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
              <td class="drop-target"></td>
            </tr>
          </table>

          <div id="bottom">
            ANSWER: <span id="answer" class="letter-cell-block create-from-pattern" data-letter-pattern="5" data-input-style="grid"></span>
          </div>

        </div>
      </div>
      
      <div id="meta-materials">
        <p>
          Meta materials discovered so far...
          <span id="7A" class="meta-found"><img src="Icons/Seven.png"><sub>A</sub></span>
          <span id="7B" class="meta-found"><img src="Icons/Seven.png"><sub>B</sub></span>
          <span id="7C" class="meta-found"><img src="Icons/Seven.png"><sub>C</sub></span>
          <span id="7D" class="meta-found"><img src="Icons/Seven.png"><sub>D</sub></span>
          <span id="7E" class="meta-found"><img src="Icons/Seven.png"><sub>E</sub></span>
          <span id="7F" class="meta-found"><img src="Icons/Seven.png"><sub>F</sub></span>
          <span id="7G" class="meta-found"><img src="Icons/Seven.png"><sub>G</sub></span>
        </p>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
        <div class="drag-source drop-target"></div>
      </div>

    </div>  
  </body>
  <script>
    var squares={};

    function onLoad() {
      textAndDragSetup();
      window.onfocus=function(e){initMaterials()};
      if (!isIFrame()) {
        initMaterials();
      }
    }

    function initMaterials() {
      for (var i = 1; i <= 16; i++) {
        if (i in squares) {
          continue;
        }
        var materials = loadMetaMaterials('Seven', 0, i);
        if (materials != null) {
          squares[i] = materials;
          buildSquare(i, materials);
        }
      }
    }

    function buildSquare(index, materials) {
      var container = findEmptySource();

      // Create a small square that can be drag-dropped
      var small = document.createElement('div');
      small.classList.add('square');
      small.classList.add('small');
      small.classList.add('moveable');
      small.setAttribute('draggable', 'true');
      container.appendChild(small);
      preprocessMoveable(small);

      var title = document.createElement('div');
      title.classList.add('title');
      title.innerText = materials['title'];
      small.appendChild(title);

      var doors = materials['doors'];
      for (var d = 0; d < doors.length; d++) {
        var door = document.createElement('div');
        door.classList.add('exit');
        door.classList.add(doors[d]);
        small.appendChild(door);
      }

      var tipEmoji = document.createElement('span');
      tipEmoji.classList.add('tip-emoji');
      tipEmoji.innerText = 'ðŸ“„'; // '&#x1F4C4;';
      small.appendChild(tipEmoji);

      // Create a bigger square that can be hovered upon
      var big = document.createElement('div');
      big.classList.add('square');
      big.classList.add('big');
      tipEmoji.appendChild(big);

      for (var d = 0; d < doors.length; d++) {
        var door = document.createElement('div');
        door.classList.add('exit');
        door.classList.add(doors[d]);
        big.appendChild(door);
      }

      title = document.createElement('div');
      title.classList.add('title');
      title.innerText = materials['title'];
      big.appendChild(title);
      var desc = document.createElement('p');
      desc.classList.add('description');
      desc.innerText = materials['description'];
      big.appendChild(desc);
      var exits = document.createElement('p');
      exits.classList.add('exits');
      exits.innerText = materials['exits'];
      big.appendChild(exits);

      // Animate this square's arrival just like drag-drop
      toggleClass(small, 'placed', true);

      var found = document.getElementById(materials['page']);
      found.style.display = 'inline';
    }
  </script>
</html>
